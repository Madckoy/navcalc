// â–‘â–ˆâ–€â–„â–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–‘â–‘â–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–€â–„â–‘â–ˆâ–‘â–ˆâ–‘â–€â–ˆâ–€â–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–€â–€
// â–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–€â–€â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–€â–„â–‘â–ˆâ–‘â–ˆâ–‘â–‘â–ˆâ–‘â–‘â–ˆâ–‘â–ˆâ–‘â–€â–€â–ˆ
// â–‘â–€â–€â–‘â–‘â–€â–€â–€â–‘â–€â–‘â–‘â–‘â–€â–€â–€â–‘â–€â–€â–€â–‘â–€â–‘â–€â–‘â–€â–‘â–€â–‘â–€â–€â–€â–‘â–‘â–€â–‘â–‘â–€â–‘â–€â–‘â–€â–€â–€
//  ğŸ© Generated by ChatGPT â€” with a touch of pixelated magic
// ------------------------------------------------------------

package com.devone.bot.core.navigation.filters;

import com.devone.bot.utils.BlockMaterialUtils;
import com.devone.bot.utils.BotBlockData;

import java.util.*;

public class BotThreadSurfaceFilter {

    /**
     * ĞŸÑ€Ğ¾ÑÑ‚Ğ°Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ: Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ±Ğ»Ğ¾ĞºĞ¸, Ğ½Ğ°Ğ´ ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¼Ğ¸ ÑĞ²Ğ½Ğ¾ ĞµÑÑ‚ÑŒ Ğ´Ğ²Ğ° ÑƒÑ€Ğ¾Ğ²Ğ½Ñ Ğ²Ğ¾Ğ·Ğ´ÑƒÑ…Ğ°.
     */
    public static List<BotBlockData> filterWalkableSurfaceBlocks(List<BotBlockData> blocks) {
        Map<String, BotBlockData> blockMap = new HashMap<>();
        int maxY = blocks.stream().mapToInt(b -> b.y).max().orElse(Integer.MAX_VALUE);

        for (BotBlockData block : blocks) {
            String key = block.x + "," + block.y + "," + block.z;
            blockMap.put(key, block);
        }

        List<BotBlockData> result = new ArrayList<>();

        for (BotBlockData block : blocks) {
            int x = block.x;
            int y = block.y;
            int z = block.z;

            if (y + 2 > maxY) continue; // Ğ¸ÑĞºĞ»ÑÑ‡Ğ°ĞµĞ¼ Ğ²ĞµÑ€Ñ…Ğ½Ğ¸Ğµ ÑƒÑ€Ğ¾Ğ²Ğ½Ğ¸ Ğ±ĞµĞ· Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

            String key1 = x + "," + (y + 1) + "," + z;
            String key2 = x + "," + (y + 2) + "," + z;

            boolean airAbove1 = !blockMap.containsKey(key1) || BlockMaterialUtils.isAir(blockMap.get(key1).type);
            boolean airAbove2 = !blockMap.containsKey(key2) || BlockMaterialUtils.isAir(blockMap.get(key2).type);

            if (airAbove1 && airAbove2) {
                result.add(block);
            }
        }

        return result;
    }
}
